<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Reminder Manager</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/login.css">
</head>
<body>
<div class="login-container">
    <div class="login-header">
        <h1>Reminder Manager</h1>
        <p>Sign in to manage your reminders</p>
    </div>

    <div id="messageContainer" class="message-container"></div>

    <form id="loginForm" class="login-form">
        <div class="form-group">
            <label for="username">Username</label>
            <input type="text" id="username" name="username" required autocomplete="username" placeholder="Enter your username">
        </div>

        <div class="form-group">
            <label for="password">Password</label>
            <input type="password" id="password" name="password" required autocomplete="current-password" placeholder="Enter your password">
        </div>

        <div class="form-options">
            <label class="checkbox-container">
                <input type="checkbox" id="rememberMe">
                <span class="checkmark"></span>
                Remember me
            </label>
        </div>

        <button type="submit" class="login-btn" id="loginBtn">
            <span class="btn-text">Sign In</span>
            <span class="btn-loader" style="display: none;">Signing in...</span>
        </button>
    </form>

    <div class="demo-credentials">
        <h4>Demo Credentials</h4>
        <div class="credential-item" data-username="admin" data-password="password123">
            <strong>Admin:</strong> admin / password123
        </div>
        <div class="credential-item" data-username="user" data-password="userpass123">
            <strong>User:</strong> user / userpass123
        </div>
        <div class="credential-item" data-username="manager" data-password="manager456">
            <strong>Manager:</strong> manager / manager456
        </div>
    </div>

    <div class="login-footer">
        <p>&copy; 2025 Reminder Manager. All rights reserved.</p>
    </div>
</div>

<!-- Floating background shapes -->
<div class="floating-shape"></div>
<div class="floating-shape"></div>
<div class="floating-shape"></div>

<!-- Load scripts in proper order -->
<script src="../config/constants.js"></script>
<script src="../js/utils.js"></script>
<script src="../js/auth.js"></script>
<script>
    // Initialize login page when everything is loaded
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Login page: DOM loaded');

        // Wait for all dependencies to be available
        let initAttempts = 0;
        const maxAttempts = 50;

        function attemptInit() {
            initAttempts++;

            // Check if all required modules are loaded
            if (typeof Utils !== 'undefined' &&
                typeof Auth !== 'undefined' &&
                typeof APP_CONFIG !== 'undefined' &&
                typeof DEMO_USERS !== 'undefined') {

                console.log('All modules loaded, initializing login page...');
                Auth.initLoginPage();

            } else if (initAttempts < maxAttempts) {
                console.log(`Waiting for modules... (${initAttempts}/${maxAttempts})`);
                setTimeout(attemptInit, 100);
            } else {
                console.error('Failed to load required modules within timeout');
                alert('Failed to load application. Please refresh the page.');
            }
        }

        attemptInit();
    });
</script>
</body>
</html>